import{c,u as q,e as H,r as s,b as g,j as e,A as B}from"./index-DbTTv7ag.js";import{L as A}from"./loader-circle-Bxpi28eJ.js";import{S as K,A as I}from"./save-CUQ6rfrU.js";import{S as Q}from"./star-Dh13X_k5.js";import{F as X}from"./flame-Y6z8Oy63.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=c("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=c("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=c("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=c("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=c("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=c("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);function ce(){const{user:a,logout:$,updateUser:D}=q(),{theme:d,toggle:F}=H(),[m,N]=s.useState((a==null?void 0:a.display_name)||""),[j,b]=s.useState(!1),[h,x]=s.useState(""),[l,w]=s.useState(null),[R,v]=s.useState(!0),[p,k]=s.useState(""),[S,P]=s.useState(!1),[u,r]=s.useState(""),[y,C]=s.useState(""),[i,z]=s.useState(""),[M,_]=s.useState(""),[L,T]=s.useState(!1),[f,n]=s.useState("");s.useEffect(()=>{N((a==null?void 0:a.display_name)||"")},[a==null?void 0:a.display_name]),s.useEffect(()=>{(async()=>{v(!0);try{const t=await g("/api/stats/me");w(t)}catch{w(null)}finally{v(!1)}})()},[]);const E=async()=>{if(m.trim()){b(!0),x("");try{const t=await g("/api/auth/me",{method:"PUT",body:{display_name:m.trim()}});D({display_name:t.display_name||m.trim()}),x("Name updated!")}catch(t){x(t.message||"Failed to update name")}finally{b(!1),setTimeout(()=>x(""),3e3)}}},O=async()=>{if(p.length!==6||!/^\d{6}$/.test(p)){r("PIN must be exactly 6 digits");return}P(!0),r("");try{await g("/api/auth/set-pin",{method:"POST",body:{pin:p}}),r("PIN set successfully!"),k("")}catch(t){r(t.message||"Failed to set PIN")}finally{P(!1),setTimeout(()=>r(""),3e3)}},U=async()=>{if(!y||!i){n("Fill in all password fields");return}if(i!==M){n("New passwords do not match");return}if(i.length<6){n("New password must be at least 6 characters");return}T(!0),n("");try{await g("/api/auth/change-password",{method:"POST",body:{current_password:y,new_password:i}}),n("Password changed!"),C(""),z(""),_("")}catch(t){n(t.message||"Failed to change password")}finally{T(!1),setTimeout(()=>n(""),3e3)}},o="w-full bg-navy-light border-2 border-[#2a2a4a] text-cream p-3 rounded font-body text-lg placeholder:text-cream/30 focus:border-gold focus:outline-none transition-colors",V={admin:"bg-crimson/20 border-crimson text-crimson",parent:"bg-purple/20 border-purple text-purple",kid:"bg-sky/20 border-sky text-sky"};return e.jsxs("div",{className:"max-w-xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Y,{size:28,className:"text-gold"}),e.jsx("h1",{className:"font-heading text-gold text-xs sm:text-sm leading-relaxed",children:"Hero Profile"})]}),e.jsxs("div",{className:"game-panel p-6 flex flex-col items-center gap-4",children:[e.jsx(B,{config:a==null?void 0:a.avatar_config,size:"lg",name:(a==null?void 0:a.display_name)||(a==null?void 0:a.username)}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full border text-[10px] font-heading uppercase tracking-wider ${V[a==null?void 0:a.role]||"border-cream/30 text-cream/50"}`,children:a==null?void 0:a.role}),e.jsxs("div",{className:"w-full max-w-xs",children:[e.jsx("label",{className:"block text-gold/80 text-sm font-heading mb-2 tracking-wide text-center",children:"Display Name"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:t=>N(t.target.value),placeholder:"Your hero name",className:o}),e.jsx("button",{onClick:E,disabled:j,className:"game-btn game-btn-gold flex-shrink-0",children:j?e.jsx(A,{size:14,className:"animate-spin"}):e.jsx(K,{size:14})})]}),h&&e.jsx("p",{className:`text-sm mt-1 text-center ${h.includes("!")?"text-emerald":"text-crimson"}`,children:h})]})]}),e.jsxs("div",{className:"game-panel p-5",children:[e.jsx("h2",{className:"font-heading text-gold/80 text-[10px] mb-4 tracking-wide",children:"Hero Stats"}),R?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(A,{size:20,className:"text-gold animate-spin"})}):l?e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{size:20,className:"text-gold mx-auto mb-1"}),e.jsx("p",{className:"font-heading text-gold text-[11px]",children:l.xp_balance??l.xp??0}),e.jsx("p",{className:"text-cream/40 text-sm font-body",children:"XP Balance"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(I,{size:20,className:"text-emerald mx-auto mb-1"}),e.jsx("p",{className:"font-heading text-emerald text-[11px]",children:l.total_xp_earned??l.total_earned??0}),e.jsx("p",{className:"text-cream/40 text-sm font-body",children:"Total Earned"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(X,{size:20,className:"text-crimson mx-auto mb-1"}),e.jsx("p",{className:"font-heading text-crimson text-[11px]",children:l.streak??0}),e.jsx("p",{className:"text-cream/40 text-sm font-body",children:"Streak"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(I,{size:20,className:"text-purple mx-auto mb-1"}),e.jsx("p",{className:"font-heading text-purple text-[11px]",children:l.achievements_count??l.achievements??0}),e.jsx("p",{className:"text-cream/40 text-sm font-body",children:"Achievements"})]})]}):e.jsx("p",{className:"text-cream/30 text-center text-sm font-body",children:"Stats not available yet. Complete quests to build your legend!"})]}),e.jsxs("div",{className:"game-panel p-5",children:[e.jsxs("h2",{className:"font-heading text-gold/80 text-[10px] mb-4 tracking-wide flex items-center gap-2",children:[e.jsx(Z,{size:16,className:"text-gold/60"}),"Quick PIN Login"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",inputMode:"numeric",maxLength:6,value:p,onChange:t=>k(t.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"6-digit PIN",className:o}),e.jsx("button",{onClick:O,disabled:S,className:"game-btn game-btn-blue flex-shrink-0",children:S?"Setting...":"Set PIN"})]}),u&&e.jsx("p",{className:`text-sm mt-2 ${u.includes("!")?"text-emerald":"text-crimson"}`,children:u})]}),e.jsxs("div",{className:"game-panel p-5",children:[e.jsxs("h2",{className:"font-heading text-gold/80 text-[10px] mb-4 tracking-wide flex items-center gap-2",children:[e.jsx(G,{size:16,className:"text-gold/60"}),"Change Password"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"password",value:y,onChange:t=>C(t.target.value),placeholder:"Current password",autoComplete:"current-password",className:o}),e.jsx("input",{type:"password",value:i,onChange:t=>z(t.target.value),placeholder:"New password",autoComplete:"new-password",className:o}),e.jsx("input",{type:"password",value:M,onChange:t=>_(t.target.value),placeholder:"Confirm new password",autoComplete:"new-password",className:o}),e.jsx("button",{onClick:U,disabled:L,className:"game-btn game-btn-gold",children:L?"Changing...":"Change Password"})]}),f&&e.jsx("p",{className:`text-sm mt-2 ${f.includes("!")?"text-emerald":"text-crimson"}`,children:f})]}),e.jsxs("div",{className:"game-panel p-5",children:[e.jsx("h2",{className:"font-heading text-gold/80 text-[10px] mb-4 tracking-wide",children:"Appearance"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-cream font-body text-lg",children:[d==="dark"?e.jsx(W,{size:18,className:"text-purple"}):e.jsx(ee,{size:18,className:"text-gold"}),e.jsx("span",{children:d==="dark"?"Dark Realm":"Light Realm"})]}),e.jsx("button",{onClick:F,className:`relative w-14 h-7 rounded-full border-2 transition-colors ${d==="light"?"bg-gold/20 border-gold":"bg-navy-light border-[#2a2a4a]"}`,children:e.jsx("div",{className:`absolute top-0.5 w-5 h-5 rounded-full transition-all ${d==="light"?"left-7 bg-gold":"left-0.5 bg-cream/40"}`})})]})]}),e.jsx("div",{className:"pb-6",children:e.jsxs("button",{onClick:$,className:"game-btn game-btn-red w-full flex items-center justify-center gap-2",children:[e.jsx(J,{size:14}),"Leave the Realm"]})})]})}export{ce as default};

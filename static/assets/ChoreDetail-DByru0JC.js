import{c as u,d as E,u as R,a as D,r as d,b as x,j as e,S as U}from"./index-DbTTv7ag.js";import{S as B}from"./scroll-text-vAhC9Sw4.js";import{C as v}from"./circle-x-CUqGH7ad.js";import{S as V}from"./shield-BoUZ_pFx.js";import{R as X}from"./refresh-cw-Bfk4-XSH.js";import{C as Y}from"./camera-Dj7jgd-a.js";import{C as w}from"./circle-check-DW88RjrA.js";import{C as G}from"./clock-BJLivEWx.js";import{S as I}from"./star-Dh13X_k5.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=u("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=u("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=u("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]),K=["Trivial","Easy","Medium","Hard","Legendary"],W=["text-cream/60","text-emerald","text-sky","text-purple","text-gold"],J=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],z={cleaning:"bg-sky/20 text-sky border-sky/40",cooking:"bg-gold/20 text-gold border-gold/40",outdoor:"bg-emerald/20 text-emerald border-emerald/40",homework:"bg-purple/20 text-purple border-purple/40",pet_care:"bg-crimson/20 text-crimson border-crimson/40",laundry:"bg-sky/20 text-sky border-sky/40",errands:"bg-gold/20 text-gold border-gold/40",default:"bg-cream/10 text-cream/70 border-cream/20"};function Z({level:r}){return e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(t=>e.jsx(I,{size:18,className:t<=r?"text-gold fill-gold":"text-cream/20"},t)),e.jsx("span",{className:`ml-2 font-body text-lg ${W[r-1]||"text-cream/60"}`,children:K[r-1]||"Unknown"})]})}function ee({status:r}){const t={pending:"bg-gold/20 text-gold border-gold/40",completed:"bg-emerald/20 text-emerald border-emerald/40",verified:"bg-sky/20 text-sky border-sky/40",skipped:"bg-cream/10 text-cream/50 border-cream/20",missed:"bg-crimson/20 text-crimson border-crimson/40"};return e.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-sm border capitalize ${t[r]||t.pending}`,children:r||"pending"})}function de(){var N,k;const{id:r}=E(),{user:t}=R(),f=D(),T=(t==null?void 0:t.role)==="parent"||(t==null?void 0:t.role)==="admin",L=(t==null?void 0:t.role)==="kid",[a,_]=d.useState(null),[$,O]=d.useState(!0),[b,y]=d.useState(""),[l,o]=d.useState(""),[p,i]=d.useState(""),m=d.useCallback(async()=>{try{y("");const s=await x(`/api/chores/${r}`);_(s)}catch(s){y(s.message||"This quest scroll could not be found.")}finally{O(!1)}},[r]);d.useEffect(()=>{m()},[m]);const P=async()=>{o("complete"),i("");try{await x(`/api/chores/${r}/complete`,{method:"POST"}),i("Quest completed! XP has been awarded to your hero."),await m()}catch(s){i(s.message||"Failed to complete the quest.")}finally{o("")}},M=async s=>{o("verify"),i("");try{const c=s?`/api/chores/assignments/${s}/verify`:`/api/chores/${r}/verify`;await x(c,{method:"POST"}),i("Quest verified! The hero has been rewarded."),await m()}catch(c){i(c.message||"Verification failed.")}finally{o("")}},Q=async s=>{o("uncomplete"),i("");try{const c=s?`/api/chores/assignments/${s}/uncomplete`:`/api/chores/${r}/uncomplete`;await x(c,{method:"POST"}),i("Quest marked as incomplete."),await m()}catch(c){i(c.message||"Could not undo completion.")}finally{o("")}},F=async s=>{o("skip"),i("");try{const c=s?`/api/chores/assignments/${s}/skip`:`/api/chores/${r}/skip`;await x(c,{method:"POST"}),i("Quest skipped for today."),await m()}catch(c){i(c.message||"Could not skip the quest.")}finally{o("")}};if($)return e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[e.jsx(B,{size:48,className:"text-gold animate-pulse"}),e.jsx("p",{className:"text-gold font-heading text-xs animate-pulse",children:"Unrolling the quest scroll..."})]});if(b)return e.jsxs("div",{className:"max-w-2xl mx-auto py-10",children:[e.jsxs("button",{onClick:()=>f("/chores"),className:"flex items-center gap-2 text-cream/50 hover:text-cream transition-colors mb-6",children:[e.jsx(C,{size:18}),e.jsx("span",{className:"font-body text-lg",children:"Back to Quest Board"})]}),e.jsxs("div",{className:"game-panel p-10 text-center",children:[e.jsx(v,{size:48,className:"mx-auto text-crimson mb-4"}),e.jsx("p",{className:"text-crimson font-heading text-xs mb-2",children:"Quest Not Found"}),e.jsx("p",{className:"text-cream/50 font-body text-lg",children:b})]})]});if(!a)return null;const q=z[(N=a.category)==null?void 0:N.toLowerCase()]||z.default,j=a.assignments||a.history||[],h=new Date().toISOString().split("T")[0],n=j.find(s=>s.date===h||s.assigned_date===h||s.due_date===h),A=n&&(n.status==="pending"||n.status==="assigned"),g=j.slice(0,10);return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("button",{onClick:()=>f("/chores"),className:"flex items-center gap-2 text-cream/50 hover:text-cream transition-colors",children:[e.jsx(C,{size:18}),e.jsx("span",{className:"font-body text-lg",children:"Back to Quest Board"})]}),e.jsxs("div",{className:"game-panel p-6 space-y-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(U,{size:28,className:"text-gold flex-shrink-0 mt-1"}),e.jsx("div",{className:"flex-1",children:e.jsx("h1",{className:"font-heading text-gold text-sm sm:text-base leading-relaxed",children:a.title})})]}),a.description&&e.jsx("div",{className:"pl-10",children:e.jsx("p",{className:"text-cream/70 font-body text-xl leading-relaxed",children:a.description})}),e.jsx("div",{className:"mx-auto w-full h-[1px] bg-gradient-to-r from-transparent via-[#2a2a4a] to-transparent"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gold/10 flex items-center justify-center",children:e.jsx("span",{className:"text-gold text-xl",children:"â˜…"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-cream/40 text-sm font-body",children:"XP Reward"}),e.jsxs("p",{className:"text-gold font-heading text-xs",children:[a.points," XP"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-cream/40 text-sm font-body mb-1",children:"Difficulty"}),e.jsx(Z,{level:a.difficulty||1})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#2a2a4a] flex items-center justify-center",children:e.jsx(V,{size:18,className:"text-cream/50"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-cream/40 text-sm font-body",children:"Category"}),e.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-sm border capitalize ${q}`,children:a.category||"General"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#2a2a4a] flex items-center justify-center",children:e.jsx(X,{size:18,className:"text-cream/50"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-cream/40 text-sm font-body",children:"Recurrence"}),e.jsxs("p",{className:"text-cream font-body text-lg capitalize",children:[a.recurrence||"Once",a.recurrence==="custom"&&((k=a.custom_days)==null?void 0:k.length)>0&&e.jsxs("span",{className:"text-cream/40 text-base ml-1",children:["(",a.custom_days.map(s=>J[s]||s).join(", "),")"]})]})]})]})]}),a.requires_photo&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded bg-purple/10 border border-purple/30",children:[e.jsx(Y,{size:16,className:"text-purple"}),e.jsx("span",{className:"text-purple font-body text-base",children:"Photo proof required upon completion"})]})]}),p&&e.jsx("div",{className:`p-3 rounded border-2 text-base text-center ${p.toLowerCase().includes("fail")||p.toLowerCase().includes("could not")?"border-crimson/40 bg-crimson/10 text-crimson":"border-emerald/40 bg-emerald/10 text-emerald"}`,children:p}),L&&A&&e.jsx("div",{className:"game-panel p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gold font-heading text-[10px] mb-1",children:"Today's Quest"}),e.jsx("p",{className:"text-cream/60 font-body text-base",children:"This quest awaits your courage, adventurer!"})]}),e.jsxs("button",{onClick:P,disabled:!!l,className:`game-btn game-btn-gold flex items-center gap-2 ${l==="complete"?"opacity-60 cursor-wait":""}`,children:[e.jsx(w,{size:16}),l==="complete"?"Completing...":"Complete Quest"]})]})}),T&&e.jsxs("div",{className:"game-panel p-5",children:[e.jsx("p",{className:"text-gold font-heading text-[10px] mb-3",children:"Guild Master Actions"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>M(n==null?void 0:n.id),disabled:!!l,className:`game-btn game-btn-gold flex items-center gap-2 ${l==="verify"?"opacity-60 cursor-wait":""}`,children:[e.jsx(w,{size:14}),l==="verify"?"Verifying...":"Verify"]}),e.jsxs("button",{onClick:()=>Q(n==null?void 0:n.id),disabled:!!l,className:`game-btn game-btn-blue flex items-center gap-2 ${l==="uncomplete"?"opacity-60 cursor-wait":""}`,children:[e.jsx(v,{size:14}),l==="uncomplete"?"Undoing...":"Uncomplete"]}),e.jsxs("button",{onClick:()=>F(n==null?void 0:n.id),disabled:!!l,className:`game-btn game-btn-red flex items-center gap-2 ${l==="skip"?"opacity-60 cursor-wait":""}`,children:[e.jsx(H,{size:14}),l==="skip"?"Skipping...":"Skip Today"]})]})]}),g.length>0&&e.jsxs("div",{className:"game-panel p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{size:18,className:"text-gold"}),e.jsx("h2",{className:"font-heading text-gold text-[10px]",children:"Quest Log"})]}),e.jsx("div",{className:"space-y-2",children:g.map((s,c)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded bg-[#2a2a4a]/30 border border-[#2a2a4a]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{size:14,className:"text-cream/30"}),e.jsx("span",{className:"text-cream/60 font-body text-base",children:s.date||s.assigned_date||s.due_date||"N/A"}),s.assigned_to_name&&e.jsxs("span",{className:"text-cream/40 font-body text-sm",children:["- ",s.assigned_to_name]})]}),e.jsx(ee,{status:s.status})]},s.id||c))})]}),g.length===0&&e.jsxs("div",{className:"game-panel p-8 text-center",children:[e.jsx(S,{size:32,className:"mx-auto text-cream/20 mb-3"}),e.jsx("p",{className:"text-cream/40 font-body text-lg",children:"No entries in the quest log yet. Adventures await!"})]})]})}export{de as default};
